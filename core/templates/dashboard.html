{% extends "base.html" %}
{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card p-4 mb-4">
            <h4>Welcome, {{ user.get_full_name|default:user.username }}</h4>
            <p>Role: {{ profile.role }}</p>
            <p><a class="btn btn-sm btn-outline-primary" href="{% url 'book_appointment' %}">Book Appointment</a>
                <a class="btn btn-sm btn-outline-secondary" href="{% url 'upload_record' %}">Upload Records</a></p>
        </div>

        <div class="card p-4 mb-4">
            <h5>Appointments</h5>
            {% if appointments %}
            <ul class="list-group">
                {% for a in appointments %}
                <li class="list-group-item">
                    {{ a.date }} {{ a.time }} â€”
                    {% if a.patient %} Patient: {{ a.patient }} {% endif %}
                    {% if a.doctor %} Doctor: {{ a.doctor }} {% endif %}
                    <div class="text-muted small">{{ a.status }}</div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p>No appointments yet.</p>
            {% endif %}
        </div>

        <div class="card p-4">
            <h5>Medical Records</h5>
            {% if records %}
            <div class="row">
                {% for r in records %}
                <div class="col-md-3">
                    <div class="card p-2 mb-2">
                        <p>{{ r.title }}</p>
                        <a href="{{ r.file.url }}" target="_blank">Download</a>
                        <div class="text-muted small">{{ r.uploaded_at }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p>No records uploaded.</p>
            {% endif %}
        </div>
    </div>

    <div class="col-md-4">
        <div class="card p-4 mb-4">
            <h6>Profile</h6>
            <p>{{ user.email }}</p>
            <p>Phone: {{ profile.phone }}</p>
            <p>Age: {{ profile.age }}</p>
        </div>
        <div class="card p-4">
            <h6>Quick Actions</h6>
            <ul class="list-unstyled">
                <li><a href="{% url 'book_appointment' %}">Book Appointment</a></li>
                <li><a href="{% url 'upload_record' %}">Upload Medical Record</a></li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}
